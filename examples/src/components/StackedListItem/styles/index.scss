@use '../../../styles/utils/shared/layout';
@use '../../../styles/utils/shared/typography';
@use 'props';
@use 'variants';

.stacked-list {
	position: relative;
	margin-top: -(map-get(theme.$border, 'thin'));

	@media screen and (min-width: map-get(theme.$breakpoint, 'md')) {
		margin-top: -(map-get(theme.$border, 'base'));
	}

	&::before {
		@include visible(false);
		@include position-cover;
		@include heading;
		@include heading-4;
		@include text-no-select;
		// stylelint-disable-next-line shopify/content-no-strings
		content: 'drop items here';
		display: flex;
		align-items: center;
		justify-content: center;
		text-align: center;
		width: 80%;
		height: 80%;
		background-color: white;
		transition: opacity map-get(theme.$duration, 'base') map-get(theme.$easing, 'base'),
			visibility map-get(theme.$duration, 'base') map-get(theme.$easing, 'base');
	}

	&:empty {
		&::before {
			@include visible;
		}
	}

	&__wrapper {
		@include stripes-bg;
		position: relative;
		color: map-get(theme.$color, 'coal-dark');
		box-shadow: inset 0 0 0 map-get(theme.$border, 'thin') currentColor;
		// `draggable-container-parent--capacity` changes the `color` on `stacked-listWrapper`...
		// This is supposed to "trickle" down and cause all children to transition color as well...
		// Problem is, sometimes these transitions seem to collide and we don't get syncronised timing...
		// Sadly, there is no way to target `box-shadow`'s color without the use of currentColor.
		// transition: color map-get(theme.$duration, 'fast') map-get(theme.$easing, 'base');

		@media screen and (min-width: map-get(theme.$breakpoint, 'md')) {
			box-shadow: inset 0 0 0 map-get(theme.$border, 'base') currentColor;
		}
	}

	&__header,
	&__content {
		// cannot be `min-height`, as a child's `height: 100%` will not work
		// by using `height`, we will get visible scrollbars
		height: props.stacked-list-item();

		@media screen and (min-width: map-get(theme.$breakpoint, 'lg')) {
			height: props.stacked-list-item(base, desktop);
		}
	}

	&__header {
		padding: props.stacked-list-header(padding);
		background-color: currentColor;
		transition: color map-get(theme.$duration, 'fast') map-get(theme.$easing, 'base');

		@media screen and (min-width: map-get(theme.$breakpoint, 'md')) {
			padding: props.stacked-list-header(padding, tablet);
		}

		p {
			margin-top: 0.2em;
			font-size: 2rem;
			color: white;
		}
	}

	&__item {
		cursor: cursor: map-get(theme.$cursor, 'base');

		&:nth-child(1n + 2) {
			margin-top: -(map-get(theme.$border, 'thin'));

			@media screen and (min-width: map-get(theme.$breakpoint, 'md')) {
				margin-top: -(map-get(theme.$border, 'base'));
			}
		}

		.draggable--original:first-child + & {
			margin-top: 0;
		}
	}

	&__content {
		position: relative;
		display: flex;
		align-items: center;
		padding: map-get(theme.$spacing, 'tighter');
		color: currentColor;
		background-color: map-get(theme.$color, 'ash-light');
		border: map-get(theme.$border, 'thin') solid currentColor;
		transition: color map-get(theme.$duration, 'fast') map-get(theme.$easing, 'base'),
			background-color map-get(theme.$duration, 'fast') map-get(theme.$easing, 'base'),
			transform map-get(theme.$duration, 'base') map-get(theme.$easing, 'bungie');

		@media screen and (min-width: map-get(theme.$breakpoint, 'md')) {
			border-width: map-get(theme.$border, 'base');
		}

		.heading {
			flex: 1 1 auto;
		}

		.drag-handle,
		.nope-handle {
			flex: 0 0 $handle-size;
			margin-left: map-get(theme.$spacing, 'tight');
		}

		// top border psuedo element... solution to create a collapsed border
		// required to make the hover style highlight each side of the element
		&::before {
			content: '';
			position: absolute;
			top: -(map-get(theme.$border, 'thin'));
			right: -(map-get(theme.$border, 'thin'));
			left: -(map-get(theme.$border, 'thin'));
			display: block;
			height: map-get(theme.$border, 'thin');
			background-color: currentColor;
			opacity: 0;
			transition: color map-get(theme.$duration, 'fast') map-get(theme.$easing, 'base'),
				opacity map-get(theme.$duration, 'fast') map-get(theme.$easing, 'base');

			@media screen and (min-width: map-get(theme.$breakpoint, 'md')) {
				top: -(map-get(theme.$border, 'base'));
				right: -(map-get(theme.$border, 'base'));
				left: -(map-get(theme.$border, 'base'));
				height: map-get(theme.$border, 'base');
			}
		}
	}
}
